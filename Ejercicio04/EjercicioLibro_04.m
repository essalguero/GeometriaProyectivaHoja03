clc
clear all

x1 = [2.538936385222061 9.664067426183657 1];
x2 = [8.658672591526601 2.851530894637108 1];
x3 = [19.916677876709482 11.684735041472887 1];
x4 = [20.78267828326201 14.97553658637249 1];
x5 = [8.139072347595084 6.200065799973547 1];
x6 = [1.2688024556116848 13.243535773267435 1];
x7 = [13.046407984726082 18.78593837520361 1];
x8 = [6.868938417984707 15.495136830304007 1];
x9 = [13.68147494953127 10.645534553609854 1];
x10 = [19.108410830593787 14.167269540256799 1];
x11 = [19.050677470156952 15.437403469867172 1];
x12 = [13.5660082286576 11.627001681036052 1];
x13 = [6.695738336674201 16.53433731816704 1];
x14 = [11.834007415552541 19.016871816950953 1];

x1_ = [3.653930170839321 8.289940984711434 1];
x2_ = [11.854431244589355 3.587283970854776 1];
x3_ = [17.956225882403363 13.225787602560985 1];
x4_ = [18.65579469438204 15.713143378485167 1];
x5_ = [12 6 1];
x6_ = [2.6434418868701224 11.049351298627323 1];
x7_ = [10.921672828617787 18.511418626399873 1];
x8_ = [6.801989824743362 14.352870688526629 1];
x9_ = [14.691571426502874 10.816161694634431 1];
x10_ = [17.528711608416394 14.780384962513597 1];
x11_ = [17.72303627841047 15.829738180481613 1];
x12_ = [14.808166228499319 11.515730506613108 1];
x13_ = [6.685395022746916 15.246764170499382 1];
x14_ = [10.222104016639111 18.472553692401057 1];

x = [x1; x2; x3; x4; x5; x6; x7; x8; x9; x10; x11; x12; x13; x14];
x_ = [x1_; x2_; x3_; x4_; x5_; x6_; x7_; x8_; x9_; x10_; x11_; x12_; x13_; x14_];

[F,e1,e2] = fundmatrix2(x', x_');

ex = [0, -e2(3) e2(2); e2(3) 0 -e2(1); -e2(2) e2(1) 0];

P1 = eye(3);
P1 = [P1, [0; 0; 0]];
P2 = ex * F;
P2 = [P2 , e2];


%x'(1,:)*P(3) - P(1)
%x'(2,:)*P(3) - P(2)
%
%x_'(1,:)*P_(3) - P_(1)
%x_'(2,:)*P_(3) - P_(2)
%A = zeros(14, 4);

X = zeros(14, 4)

for i = [1:14]

B = x(i,1)*P1(3,:) - P1(1,:);
C = x(i,2)*P1(3,:) - P1(2,:);
D = x_(i,1)*P2(3,:) - P2(1,:);
E = x_(i,2)*P2(3,:) - P2(2,:);

A = [B; C; D; E];

X(i,:) = A \ [0, 0, 0, 1]';
X(i,:) = X(i,:)./X(i,4);
end

X

[U, S, V] = svd(X)


plot(X)


%H=[h1 h2 h3 h4;
%h5 h6 h7 h8;
%h9 h10 h11 h12;
%h13 h14 h15 1]
%
%point = [x, y, z, 1]
%
%H * point'

